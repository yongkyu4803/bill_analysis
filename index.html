<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="법안 관리 시스템 - 법안 등록, 검토, 처리를 위한 웹 애플리케이션">
    <meta name="author" content="yongkyu4803">
    <title>법률안 분석 리포트</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- 커스텀 CSS -->
    <link href="css/style.css" rel="stylesheet">
    <!-- Supabase 클라이언트 라이브러리 - 최신 버전 사용 -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.5/dist/umd/supabase.min.js"></script>
    <style>
        /* 모바일 최적화를 위한 여백 조정 */
        @media (max-width: 768px) {
            .container {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            
            .row {
                margin-left: -0.5rem;
                margin-right: -0.5rem;
            }
            
            .col-lg-8, .col-lg-4 {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            
            .table th, .table td {
                padding: 0.5rem 0.25rem;
            }
            
            .btn-sm {
                padding: 0.25rem 0.4rem;
            }
        }
        
        /* 상임위 배지 스타일 */
        .badge.rounded-pill {
            font-weight: normal;
            padding: 0.35em 0.65em;
            border-radius: 50rem;
        }
    </style>
</head>
<body>
    <header class="bg-primary text-white py-3 shadow-sm">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <h1 class="mb-0 fs-3">법률안 분석 리포트</h1>
                <div class="d-flex align-items-center">
                    <div class="input-group me-3">
                        <input type="text" id="searchInput" class="form-control" placeholder="법안 검색...">
                        <button class="btn btn-light" type="button" id="searchBtn">
                            <i class="bi bi-search"></i>
                        </button>
                    </div>
                    <button id="loginBtn" class="btn btn-outline-light" type="button">
                        <i class="bi bi-person-fill me-1"></i>관리자 로그인
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="container my-4">
        <div class="row">
            <!-- 법안 목록 -->
            <div class="col-lg-8">
                <div id="formContainer" class="collapse mb-4">
                    <div class="form-container">
                        <h3 class="fs-5 mb-3">법안 등록</h3>
                        <form id="billForm">
                            <div class="row">
                                <div class="col-md-9 mb-3">
                                    <label for="billTitle" class="form-label">법안 제목</label>
                                    <input type="text" class="form-control" id="billTitle" name="billTitle" required>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label for="billCommittee" class="form-label">상임위</label>
                                    <select class="form-select" id="billCommittee" name="billCommittee">
                                        <option value="">선택...</option>
                                        <option value="국토">국토</option>
                                        <option value="농림">농림</option>
                                        <option value="문체">문체</option>
                                        <option value="과방">과방</option>
                                        <option value="복지">복지</option>
                                        <option value="산자">산자</option>
                                        <option value="환노">환노</option>
                                        <option value="정무">정무</option>
                                        <option value="기재">기재</option>
                                        <option value="법사">법사</option>
                                        <option value="행안">행안</option>
                                        <option value="외통">외통</option>
                                        <option value="국방">국방</option>
                                        <option value="여가">여가</option>
                                        <option value="교육">교육</option>
                                        <option value="정보">정보</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="billProposer" class="form-label">제안자</label>
                                <input type="text" class="form-control" id="billProposer" name="billProposer" required>
                            </div>
                            
                            <!-- 탭 메뉴 추가 -->
                            <div class="mb-3">
                                <label class="form-label">법안 내용</label>
                                <ul class="nav nav-tabs" id="contentTab" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="html-tab" data-bs-toggle="tab" data-bs-target="#html-content" type="button" role="tab" aria-controls="html-content" aria-selected="true">HTML</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="markdown-tab" data-bs-toggle="tab" data-bs-target="#markdown-content" type="button" role="tab" aria-controls="markdown-content" aria-selected="false">마크다운</button>
                                    </li>
                                </ul>
                                <div class="tab-content pt-2" id="contentTabContent">
                                    <div class="tab-pane fade show active" id="html-content" role="tabpanel" aria-labelledby="html-tab">
                                        <textarea class="form-control" id="billContent" name="billContent" rows="6" required></textarea>
                                        <small class="text-muted">HTML 형식으로 직접 입력합니다.</small>
                                    </div>
                                    <div class="tab-pane fade" id="markdown-content" role="tabpanel" aria-labelledby="markdown-tab">
                                        <textarea class="form-control" id="billMarkdownContent" name="billMarkdownContent" rows="6"></textarea>
                                        <div class="d-flex justify-content-between align-items-center mt-2">
                                            <small class="text-muted">마크다운 구문으로 작성합니다. (# 제목, **굵게**, *기울임*, [링크](URL) 등)</small>
                                            <button type="button" class="btn btn-sm btn-outline-secondary" id="previewMarkdownBtn">미리보기</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="text-end">
                                <button type="button" class="btn btn-outline-secondary me-2" data-bs-toggle="collapse" data-bs-target="#formContainer">
                                    취소
                                </button>
                                <button type="button" class="btn btn-primary" id="submitFormBtn">등록</button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- 법안 목록 표시 영역 -->
                <div id="billList" class="bill-list"></div>
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div>
                        <button class="btn btn-primary admin-only d-none" data-bs-toggle="collapse" data-bs-target="#formContainer">
                            <i class="bi bi-plus-lg me-1"></i> 보고서 등록
                        </button>
                    </div>
                </div>
                
                <!-- 법안 등록 폼 -->
                
            </div>
            
            <!-- 사이드바 (통계 등) -->
            <div class="col-lg-4">                
                <div class="card mt-4">
                    <div class="card-header bg-light">
                        <h3 class="fs-5 mb-0">공지사항</h3>
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item px-0">
                                <div class="d-flex justify-content-between">
                                    <span>(test)법안 관리 시스템 업데이트 안내</span>
                                    <span class="text-muted small">2025-04-21</span>
                                </div>
                            </li>
                            <li class="list-group-item px-0">
                                <div class="d-flex justify-content-between">
                                    <span>(test)개인정보 보호 조치 강화 안내</span>
                                    <span class="text-muted small">2025-04-21</span>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 모달 템플릿 로드 -->
    <div id="modalContainer">
        <!-- 여기에 모달이 동적으로 로드됩니다 -->
    </div>

    <!-- 알림 컨테이너 -->
    <div id="alertContainer"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- 커스텀 JS -->
    <script src="js/app.js"></script>
    
    <!-- Supabase 초기 설정 안내 -->
    <!-- 
    Supabase 프로젝트 설정 방법:
    1. Supabase 계정 생성 및 프로젝트 생성: https://supabase.com
    2. 프로젝트의 URL과 anon key를 app.js 파일의 SUPABASE_URL과 SUPABASE_ANON_KEY에 입력
    3. Supabase 프로젝트 설정의 Authentication > URL Configuration에서 Site URL과 Redirect URLs 설정
       - Site URL: 배포된 웹앱의 URL (ex: https://your-vercel-url.vercel.app) 또는 개발 시 http://localhost:3000
       - Redirect URLs: 동일하게 설정
    4. Authentication > Providers에서 Email 로그인과 원하는 소셜 로그인(Google 등) 활성화
    5. Email 설정의 경우 이메일 확인 요구 여부 설정
    6. SQL 편집기에서 다음 쿼리를 실행하여 관리자 역할 설정:
        UPDATE auth.users
        SET raw_user_meta_data = jsonb_set(raw_user_meta_data, '{role}', '"admin"')
        WHERE email = '관리자로 설정할 이메일 주소';
    -->
</body>
</html> 