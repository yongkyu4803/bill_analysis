<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="법안 관리 시스템 - 법안 등록, 검토, 처리를 위한 웹 애플리케이션">
    <meta name="author" content="yongkyu4803">
    <title>법률안 분석 리포트</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- 커스텀 CSS -->
    <link href="css/style.css" rel="stylesheet">
    <!-- Supabase 클라이언트 라이브러리 - 최신 버전 사용 -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.5/dist/umd/supabase.min.js"></script>
    <style>
        /* 모바일 최적화를 위한 여백 조정 */
        @media (max-width: 768px) {
            .container {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            
            .row {
                margin-left: -0.5rem;
                margin-right: -0.5rem;
            }
            
            .col-lg-8, .col-lg-4 {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            
            .table th, .table td {
                padding: 0.5rem 0.25rem;
            }
            
            .btn-sm {
                padding: 0.25rem 0.4rem;
            }
            
            /* 테이블 간 여백 제거 */
            .table-responsive {
                margin-bottom: 0;
            }
            
            /* 테이블 사이 여백 제거 */
            .table-responsive + .table-responsive {
                margin-top: 0;
            }
            
            /* 테이블 자체의 마진 조정 */
            .table {
                margin-bottom: 0;
            }
        }
        
        /* 상임위 배지 스타일 */
        .badge.rounded-pill {
            font-weight: normal;
            padding: 0.35em 0.65em;
            border-radius: 50rem;
        }

        /* 커서 스타일 */
        .cursor-pointer, .bill-title {
            cursor: pointer;
        }

        .bill-title:hover {
            color: #0d6efd;
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <header class="bg-primary text-white py-3 shadow-sm">
        <div class="container">
            <div class="d-flex flex-column flex-md-row justify-content-between align-items-center">
                <h1 class="mb-2 mb-md-0 fs-3 text-center text-md-start">법률안 분석 리포트</h1>
                <div class="d-flex flex-column flex-md-row align-items-center">
                    <div class="input-group mb-2 mb-md-0 me-md-3" style="max-width: 200px;">
                        <input type="text" id="searchInput" class="form-control" placeholder="법안 검색...">
                        <button class="btn btn-light" type="button" id="searchBtn">
                            <i class="bi bi-search"></i>
                        </button>
                    </div>
                    <button id="loginBtn" class="btn btn-outline-light" type="button">
                        <i class="bi bi-person-fill me-1"></i>관리자 로그인
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- 상임위 네비게이션 바 추가 -->
    <!-- 
    <div class="bg-light py-2 border-bottom mb-3">
        <div class="container">
            <div class="nav-scroller">
                <nav class="nav d-flex justify-content-between">
                    <a class="nav-link active" href="#">전체</a>
                    <a class="nav-link" href="#">국토</a>
                    <a class="nav-link" href="#">농림</a>
                    <a class="nav-link" href="#">문체</a>
                    <a class="nav-link" href="#">과방</a>
                    <a class="nav-link" href="#">복지</a>
                    <a class="nav-link" href="#">산자</a>
                    <a class="nav-link" href="#">환노</a>
                    <a class="nav-link" href="#">정무</a>
                    <a class="nav-link" href="#">기재</a>
                    <a class="nav-link" href="#">법사</a>
                    <a class="nav-link" href="#">행안</a>
                    <a class="nav-link" href="#">외통</a>
                    <a class="nav-link" href="#">국방</a>
                    <a class="nav-link" href="#">여가</a>
                    <a class="nav-link" href="#">교육</a>
                    <a class="nav-link" href="#">정보</a>
                </nav>
            </div>
        </div>
    </div>
    -->

    <main class="container my-4">
        <div class="row">
            <!-- 법안 목록 -->
            <div class="col-lg-8">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h2 class="fs-4 mb-0">법안 분석 보고서</h2>
                    <button id="showFormBtn" class="btn btn-primary" data-bs-toggle="collapse" data-bs-target="#formContainer">
                        <i class="bi bi-plus-lg me-1"></i>보고서 등록
                    </button>
                </div>

                <!-- 폼 섹션 -->
                <div class="collapse mb-4" id="formContainer">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <form id="billForm">
                                <div class="mb-3">
                                    <label for="billTitle" class="form-label">법안명 <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="billTitle" name="billTitle" required>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="billProposer" class="form-label">담당자 <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="billProposer" name="billProposer" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="billCommittee" class="form-label">소관위원회</label>
                                        <select class="form-select" id="billCommittee" name="billCommittee">
                                            <option value="">선택...</option>
                                            <option value="법">법</option>
                                            <option value="정">정</option>
                                            <option value="행">행</option>
                                            <option value="문">문</option>
                                            <option value="과">과</option>
                                            <option value="외">외</option>
                                            <option value="국">국</option>
                                            <option value="기">기</option>
                                            <option value="농">농</option>
                                            <option value="산">산</option>
                                            <option value="복">복</option>
                                            <option value="환">환</option>
                                            <option value="정정">정정</option>
                                            <option value="여">여</option>
                                            <option value="예">예</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- 탭 네비게이션 -->
                                <div class="nav mb-2" role="tablist">
                                    <button class="nav-link active" id="htmlTab" data-bs-toggle="tab" data-bs-target="#htmlContent" type="button" role="tab">HTML</button>
                                    <button class="nav-link" id="markdownTab" data-bs-toggle="tab" data-bs-target="#markdownPane" type="button" role="tab">마크다운</button>
                                    <button class="btn btn-outline-secondary btn-sm ms-2" id="previewBtn" type="button">
                                        <i class="bi bi-eye"></i> 미리보기
                                    </button>
                                </div>
                                
                                <!-- 탭 컨텐츠 -->
                                <div class="tab-content" id="contentTabsContent">
                                    <div class="tab-pane fade show active" id="htmlContent" role="tabpanel" aria-labelledby="htmlTab">
                                        <div class="mb-3">
                                            <label for="billContent" class="form-label">내용 <span class="text-danger">*</span></label>
                                            <textarea class="form-control" id="billContent" name="billContent" rows="10" required></textarea>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="markdownPane" role="tabpanel" aria-labelledby="markdownTab">
                                        <div class="mb-3">
                                            <label for="markdownContent" class="form-label">마크다운 내용</label>
                                            <textarea class="form-control" id="markdownContent" name="markdownContent" rows="10"></textarea>
                                        </div>
                                        <div class="mb-3 d-none" id="markdownPreview">
                                            <h5>미리보기</h5>
                                            <div class="border p-3 bg-light" id="markdownPreviewContent"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="d-flex justify-content-between mt-3">
                                    <button type="button" class="btn btn-secondary" id="cancelFormBtn" data-bs-toggle="collapse" data-bs-target="#formContainer">취소</button>
                                    <button type="button" class="btn btn-primary" id="submitFormBtn">등록</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- 법안 목록 -->
                <div class="card shadow-sm mb-4">
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead class="bg-light">
                                    <tr>
                                        <th style="width: 50%">법안명</th>
                                        <th class="d-none d-md-table-cell" style="width: 10%">위원회</th>
                                        <th class="d-none d-md-table-cell" style="width: 20%">담당자</th>
                                        <th class="d-none d-md-table-cell" style="width: 10%">등록일</th>
                                        <th style="width: 10%" class="text-end">관리</th>
                                    </tr>
                                </thead>
                                <tbody id="billTableBody">
                                    <tr>
                                        <td colspan="5" class="text-center py-3">로딩 중...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 사이드바 (통계 등) -->
            <div class="col-lg-4">                
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-light">
                        <h3 class="fs-5 mb-0">공지사항</h3>
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item px-0">
                                <div class="d-flex justify-content-between">
                                    <span>(test)법안 관리 시스템 업데이트 안내</span>
                                    <span class="text-muted small">2025-04-21</span>
                                </div>
                            </li>
                            <li class="list-group-item px-0">
                                <div class="d-flex justify-content-between">
                                    <span>(test)개인정보 보호 조치 강화 안내</span>
                                    <span class="text-muted small">2025-04-21</span>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 모달 템플릿 로드 -->
    <div id="modalContainer">
        <!-- 여기에 모달이 동적으로 로드됩니다 -->
    </div>

    <!-- 알림 컨테이너 -->
    <div id="alertContainer"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Markdown 라이브러리 추가 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/turndown/dist/turndown.js"></script>
    
    <!-- 커스텀 JS -->
    <script src="js/app.js"></script>
    
    <!-- Supabase 초기 설정 안내 -->
    <!-- 
    Supabase 프로젝트 설정 방법:
    1. Supabase 계정 생성 및 프로젝트 생성: https://supabase.com
    2. 프로젝트의 URL과 anon key를 app.js 파일의 SUPABASE_URL과 SUPABASE_ANON_KEY에 입력
    3. Supabase 프로젝트 설정의 Authentication > URL Configuration에서 Site URL과 Redirect URLs 설정
       - Site URL: 배포된 웹앱의 URL (ex: https://your-vercel-url.vercel.app) 또는 개발 시 http://localhost:3000
       - Redirect URLs: 동일하게 설정
    4. Authentication > Providers에서 Email 로그인과 원하는 소셜 로그인(Google 등) 활성화
    5. Email 설정의 경우 이메일 확인 요구 여부 설정
    6. SQL 편집기에서 다음 쿼리를 실행하여 관리자 역할 설정:
        UPDATE auth.users
        SET raw_user_meta_data = jsonb_set(raw_user_meta_data, '{role}', '"admin"')
        WHERE email = '관리자로 설정할 이메일 주소';
    -->
</body>
</html> 